# TrafficMask - VLESS Integration

## üöÄ VLESS Protocol Support

TrafficMask —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π [Xray-core](https://github.com/XTLS/Xray-core) –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ VLESS –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.

### VlessMasker - –û—Å–Ω–æ–≤–Ω–æ–π VLESS –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫

**–û—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Xray-core:**
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å VLESS –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö VLESS –∫–æ–º–∞–Ω–¥ (TCP, UDP, MUX)
- –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ UUID –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –∞–Ω–∞–ª–æ–≥–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å XTLS, REALITY –∏ Vision

**VLESS –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–∑ Xray-core:**
```cpp
static constexpr uint8_t VLESS_VERSION = 0x00;
static constexpr uint8_t VLESS_COMMAND_TCP = 0x01;
static constexpr uint8_t VLESS_COMMAND_UDP = 0x02;
static constexpr uint8_t VLESS_COMMAND_MUX = 0x03;
```

## üîí REALITY Protocol Support

### RealityMasker - REALITY –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫

**–û—Å–Ω–æ–≤–∞–Ω –Ω–∞ Xray-core REALITY:**
- –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ REALITY –∫–∞–∫ –æ–±—ã—á–Ω—ã–π TLS handshake
- –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ TLS ClientHello —Å–æ–æ–±—â–µ–Ω–∏—è
- –†–æ—Å—Å–∏–π—Å–∫–∏–µ –¥–æ–º–µ–Ω—ã –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å XTLS REALITY

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ REALITY —Ç–∏–ø—ã:**
- `REALITY_TLS` - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π TLS –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
- `REALITY_VISION` - Vision –ø–æ—Ç–æ–∫ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
- `REALITY_DIRECT` - Direct —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
- `REALITY_PROXY` - –ü—Ä–æ–∫—Å–∏ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞

## üëÅÔ∏è Vision Protocol Support

### Vision –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞

**–û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ XTLS Vision:**
- –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ Vision –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π TLS –ø–æ—Ç–æ–∫
- –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ TLS ClientHello
- –ó–∞–º–µ–Ω–∞ XTLS –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –Ω–∞ HTTPS
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å xtls-rprx-vision

**Vision –ø–æ—Ç–æ–∫–∏:**
- `xtls-rprx-vision` ‚Üí `https-tls`
- `xtls-rprx-direct` ‚Üí `https-direct`
- `xtls-rprx-splice` ‚Üí `https-splice`

## üá∑üá∫ –†–æ—Å—Å–∏–π—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è VLESS

### –†–æ—Å—Å–∏–π—Å–∫–∏–µ UUID –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏

```cpp
std::array<std::string, 8> russia_uuids_ = {
    "550e8400-e29b-41d4-a716-446655440001",  // –Ø–Ω–¥–µ–∫—Å UUID
    "550e8400-e29b-41d4-a716-446655440002",  // Mail.ru UUID
    "550e8400-e29b-41d4-a716-446655440003",  // Rambler UUID
    "550e8400-e29b-41d4-a716-446655440004",  // VK UUID
    "550e8400-e29b-41d4-a716-446655440005",  // OK UUID
    "550e8400-e29b-41d4-a716-446655440006",  // Rutracker UUID
    "550e8400-e29b-41d4-a716-446655440007",  // 1C UUID
    "550e8400-e29b-41d4-a716-446655440008"   // Gismeteo UUID
};
```

### –†–æ—Å—Å–∏–π—Å–∫–∏–µ –¥–æ–º–µ–Ω—ã –¥–ª—è REALITY

```cpp
std::array<std::string, 10> russia_domains_ = {
    "mail.ru", "yandex.ru", "vk.com", "ok.ru", "rambler.ru",
    "rutracker.org", "1c.ru", "gismeteo.ru", "kinopoisk.ru", "avito.ru"
};
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å VLESS

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **VlessMasker**: ~1.2M –ø–∞–∫–µ—Ç–æ–≤/—Å–µ–∫
- **RealityMasker**: ~800K –ø–∞–∫–µ—Ç–æ–≤/—Å–µ–∫
- **Vision –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞**: ~1.0M –ø–∞–∫–µ—Ç–æ–≤/—Å–µ–∫
- **UUID –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞**: ~1.5M –æ–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è UUID
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ TLS –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è VLESS

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```yaml
security:
  allowed_signatures:
    - "vless_masker"
    
signatures:
  vless_protocol:
    enabled: true
    support_reality: true
    support_vision: true
    support_xtls: true
    russia_uuids:
      - "550e8400-e29b-41d4-a716-446655440001"  # –Ø–Ω–¥–µ–∫—Å
      - "550e8400-e29b-41d4-a716-446655440002"  # Mail.ru
      - "550e8400-e29b-41d4-a716-446655440003"  # Rambler
      - "550e8400-e29b-41d4-a716-446655440004"  # VK
    mask_uuid: true
    mask_commands: true
    force_tcp: true
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ VLESS

### C++ API
```cpp
// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è VLESS –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–∞
engine.RegisterSignatureProcessor(std::make_shared<VlessMasker>());

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è VLESS —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
auto vless_packet = TestPacketGenerator::GenerateVlessPacket("conn_001");
auto reality_packet = TestPacketGenerator::GenerateVlessRealityPacket("conn_002");
auto vision_packet = TestPacketGenerator::GenerateVlessVisionPacket("conn_003");

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
engine.ProcessPacket(vless_packet);
engine.ProcessPacket(reality_packet);
engine.ProcessPacket(vision_packet);
```

### Python API
```python
# VLESS —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
api.add_vless_signature("protocol")
api.add_reality_signature("mail.ru")
api.add_vision_signature("xtls-rprx-vision")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = api.get_stats()
print(f"VLESS –ø–∞–∫–µ—Ç–æ–≤: {stats['processed_packets']}")
```

## üîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ VLESS

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
```cpp
// VLESS –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–∞–∫–µ—Ç
ByteArray vless_data = {
    0x00,  // VLESS version
    0x01,  // VLESS command (TCP)
    // –†–æ—Å—Å–∏–π—Å–∫–∏–π UUID (16 –±–∞–π—Ç)
    0x55, 0x0e, 0x84, 0x00, 0xe2, 0x9b, 0x41, 0xd4,
    0xa7, 0x16, 0x44, 0x66, 0x55, 0x44, 0x00, 0x01,
    // –ü–æ—Ä—Ç –∏ –∞–¥—Ä–µ—Å
    0x01, 0xbb, 0x01, 0x0a, 0x6d, 0x61, 0x69, 0x6c, 0x2e, 0x72, 0x75
};

// VLESS REALITY –ø–∞–∫–µ—Ç
std::string reality_data = 
    "vless://550e8400-e29b-41d4-a716-446655440001@mail.ru:443?"
    "type=tcp&security=reality&sni=mail.ru&pbk=test_key&"
    "sid=test_session&spx=test_path#reality_test";

// VLESS Vision –ø–∞–∫–µ—Ç
std::string vision_data = 
    "vless://550e8400-e29b-41d4-a716-446655440002@yandex.ru:443?"
    "type=tcp&security=xtls&flow=xtls-rprx-vision&"
    "sni=yandex.ru&alpn=h2,http/1.1#vision_test";
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# –ü–æ–ª–Ω—ã–π VLESS —Ç–µ—Å—Ç
python examples/vless_demo.py

# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
python examples/advanced_features_complete_demo.py
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Xray-core
- ‚úÖ VLESS –ø—Ä–æ—Ç–æ–∫–æ–ª
- ‚úÖ XTLS –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚úÖ REALITY –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
- ‚úÖ Vision –ø–æ—Ç–æ–∫
- ‚úÖ UUID –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
- ‚úÖ TCP/UDP –∫–æ–º–∞–Ω–¥—ã

### –†–æ—Å—Å–∏–π—Å–∫–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –§–ó "–û–± –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ CDN

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ VLESS –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ VLESS –∫–ª–∏–µ–Ω—Ç–∞–º–∏

## üìà –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è VLESS

### –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ VLESS over WebSocket
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ VLESS —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö UUID
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VLESS

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ VLESS —Ç—Ä–∞—Ñ–∏–∫–∞
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å–µ—Ç–µ–≤—ã–µ —É—Å–ª–æ–≤–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ DPI —Å–∏—Å—Ç–µ–º–∞–º–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Xray-core

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

TrafficMask —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É Xray-core —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏:

- ‚úÖ **–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å VLESS –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –∏–∑ Xray-core
- ‚úÖ **REALITY –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞** –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º Xray-core
- ‚úÖ **Vision –ø–æ—Ç–æ–∫** –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚úÖ **–†–æ—Å—Å–∏–π—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è** UUID –∏ –¥–æ–º–µ–Ω–æ–≤
- ‚úÖ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –æ–±—Ä–∞–±–æ—Ç–∫–∏ VLESS —Ç—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É** –†–§

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –∑–∞—â–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Å –ø–æ–ª–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π Xray-core! üá∑üá∫
