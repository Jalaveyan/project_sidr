# TrafficMask - –†–æ—Å—Å–∏–π—Å–∫–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–∏ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ VK Tunnel)

## –û–±–∑–æ—Ä —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

TrafficMask —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞—Å–∫–∏—Ä–æ–≤–∫—É —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤ –∏ IP –∞–¥—Ä–µ—Å–æ–≤, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç VK Tunnel. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ –∏ –∑–∞–∫–æ–Ω–∞–º–∏.

## –†–æ—Å—Å–∏–π—Å–∫–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–∏

### üá∑üá∫ SNI Masker –¥–ª—è –†–æ—Å—Å–∏–∏
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ SNI —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤
- **–î–æ–º–µ–Ω—ã**: vk.com, mail.ru, yandex.ru, rambler.ru, ok.ru, rutracker.org
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –í—ã—Å–æ–∫–∞—è –ª–µ–≥–∏—Ç–∏–º–Ω–æ—Å—Ç—å –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

### üåê –†–æ—Å—Å–∏–π—Å–∫–∏–π IP SIDR Masker  
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ IP —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
- **–ü—É–ª IP**: –Ø–Ω–¥–µ–∫—Å DNS, Mail.ru, Rambler, VK
- **–ü—Ä–∏–Ω—Ü–∏–ø**: –ó–∞–º–µ–Ω–∞ source IP –Ω–∞ –∞–¥—Ä–µ—Å–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π

### üöá VK Tunnel Masker
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ VK Tunnel –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- **–ó–∞–º–µ–Ω–∞**: tunnel.vk-apps.com ‚Üí vk.com, mail.ru, yandex.ru
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

## –†–æ—Å—Å–∏–π—Å–∫–∏–π –ø—É–ª –¥–æ–º–µ–Ω–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã
```
- vk.com, vk.ru (–í–ö–æ–Ω—Ç–∞–∫—Ç–µ)
- mail.ru (Mail.ru Group)
- yandex.ru (–Ø–Ω–¥–µ–∫—Å)
- ok.ru (–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏)
- rambler.ru (–†–∞–º–±–ª–µ—Ä)
- rutracker.org (–†—É—Ç—Ä–µ–∫–µ—Ä)
- 1c.ru (1C)
- gismeteo.ru (–ì–∏—Å–º–µ—Ç–µ–æ)
- kinopoisk.ru (–ö–∏–Ω–æ–ø–æ–∏—Å–∫)
- avito.ru (–ê–≤–∏—Ç–æ)
- aliexpress.ru (AliExpress Russia)
- wildberries.ru (Wildberries)
- ozon.ru (OZON)
- dns-shop.ru (DNS)
```

### –†–æ—Å—Å–∏–π—Å–∫–∏–µ CDN –∏ —Ö–æ—Å—Ç–∏–Ω–≥
```
- cdn.yandex.ru ‚Üí yandex.ru
- yastatic.net ‚Üí yandex.ru
- cdn.mail.ru ‚Üí mail.ru
- vk-cdn.com ‚Üí vk.com
- cdn.rambler.ru ‚Üí rambler.ru
- 1cbitrix.ru ‚Üí 1c.ru
```

## –†–æ—Å—Å–∏–π—Å–∫–∏–π –ø—É–ª IP –∞–¥—Ä–µ—Å–æ–≤

### –Ø–Ω–¥–µ–∫—Å DNS
```
77.88.8.8     - –û—Å–Ω–æ–≤–Ω–æ–π –Ø–Ω–¥–µ–∫—Å DNS
77.88.8.9     - –†–µ–∑–µ—Ä–≤–Ω—ã–π –Ø–Ω–¥–µ–∫—Å DNS
77.88.8.10    - –ó–∞–ø–∞—Å–Ω–æ–π –Ø–Ω–¥–µ–∫—Å DNS
77.88.8.11    - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –Ø–Ω–¥–µ–∫—Å DNS
77.88.55.55   - –Ø–Ω–¥–µ–∫—Å —Å–µ—Ä–≤–∏—Å—ã
77.88.55.56   - –Ø–Ω–¥–µ–∫—Å —Å–µ—Ä–≤–∏—Å—ã
77.88.55.57   - –Ø–Ω–¥–µ–∫—Å —Å–µ—Ä–≤–∏—Å—ã
77.88.55.58   - –Ø–Ω–¥–µ–∫—Å —Å–µ—Ä–≤–∏—Å—ã
87.250.250.242-245 - –Ø–Ω–¥–µ–∫—Å CDN
```

### Mail.ru Group
```
13.13.13.13   - –û—Å–Ω–æ–≤–Ω–æ–π Mail.ru
13.13.13.14   - –†–µ–∑–µ—Ä–≤–Ω—ã–π Mail.ru
13.13.13.15   - –ó–∞–ø–∞—Å–Ω–æ–π Mail.ru
13.13.13.16   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π Mail.ru
```

### Rambler Group
```
46.46.46.46   - –û—Å–Ω–æ–≤–Ω–æ–π Rambler
46.46.46.47   - –†–µ–∑–µ—Ä–≤–Ω—ã–π Rambler
46.46.46.48   - –ó–∞–ø–∞—Å–Ω–æ–π Rambler  
46.46.46.49   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π Rambler
```

### VK (–í–ö–æ–Ω—Ç–∞–∫—Ç–µ)
```
31.31.31.31   - –û—Å–Ω–æ–≤–Ω–æ–π VK
31.31.31.32   - –†–µ–∑–µ—Ä–≤–Ω—ã–π VK
31.31.31.33   - –ó–∞–ø–∞—Å–Ω–æ–π VK
31.31.31.34   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π VK
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### VK Tunnel –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞

```cpp
class VkTunnelMasker : public BaseSignatureProcessor {
public:
    VkTunnelMasker() : BaseSignatureProcessor("vk_tunnel_masker") {
        // –ü–æ–∏—Å–∫ VK Tunnel –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        AddPattern("tunnel\\.vk-apps\\.com");
        AddPattern("vk-apps\\.com");
        AddPattern("vkontakte\\.ru");
        AddKeyword("vk-tunnel");
    }
    
    bool ProcessPacket(Packet& packet) override {
        return MaskVkTunnel(packet.data);
    }
};
```

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:**
1. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ VK Tunnel –¥–æ–º–µ–Ω–æ–≤
2. –ó–∞–º–µ–Ω–∞ –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –¥–æ–º–µ–Ω—ã
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç—Ä–∞—Ñ–∏–∫–∞
4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### –†–æ—Å—Å–∏–π—Å–∫–∏–π SNI –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞

```cpp
bool ReplaceSniWithMask(ByteArray& data, size_t sni_offset) {
    std::vector<std::string> mask_domains = {
        "vk.com", "mail.ru", "yandex.ru", 
        "rambler.ru", "ok.ru", "rutracker.org"
    };
    
    // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –¥–æ–º–µ–Ω–∞
    std::uniform_int_distribution<> dis(0, mask_domains.size() - 1);
    std::string mask_domain = mask_domains[dis(gen)];
    
    return ReplaceSniString(data, sni_offset, mask_domain);
}
```

### –†–æ—Å—Å–∏–π—Å–∫–∏–π IP SIDR –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞

```cpp
uint32_t GenerateMaskedIp(uint32_t original_ip) {
    static std::vector<uint32_t> mask_ips = {
        0x4F4E4E4E, // 77.88.8.8 (Yandex DNS)
        0x0D0D0D0D, // 13.13.13.13 (Mail.ru)
        0x2C2C2C2C, // 46.46.46.46 (Rambler)
        0x1E1E1E1E  // 31.31.31.31 (VK)
    };
    
    // –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –º–∞–ø–ø–∏–Ω–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–µ—à–∞
    size_t index = original_ip % mask_ips.size();
    return mask_ips[index];
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –†–æ—Å—Å–∏–∏

### –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```yaml
security:
  allowed_signatures:
    - "sni_masker"        # –†–æ—Å—Å–∏–π—Å–∫–∞—è SNI –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
    - "ip_sidr_masker"    # –†–æ—Å—Å–∏–π—Å–∫–∏–π IP SIDR
    - "vk_tunnel_masker"  # VK Tunnel –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```yaml
signatures:
  sni_masking:
    enabled: true
    mask_domains:
      - "vk.com"
      - "mail.ru"
      - "yandex.ru"
      - "ok.ru"
      - "rutracker.org"
    randomize_selection: true
    
  ip_sidr:
    enabled: true
    mask_source_ip: true
    mask_pool:
      - "77.88.8.8"      # Yandex DNS
      - "13.13.13.13"    # Mail.ru
      - "46.46.46.46"    # Rambler
      - "31.31.31.31"    # VK
    consistent_mapping: true
    
  vk_tunnel:
    enabled: true
    replace_vk_apps: true
    replacement_domains:
      - "vk.com"
      - "mail.ru"
      - "yandex.ru"
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### C++ —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–∞–º–∏

```cpp
#include "trafficmask.h"
#include "signature_engine.h"

int main() {
    TrafficMask::TrafficMaskEngine engine;
    engine.Initialize("configs/config.yaml");
    
    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤
    engine.RegisterSignatureProcessor(
        std::make_shared<TrafficMask::SniMasker>()     // –†–æ—Å—Å–∏–π—Å–∫–∞—è SNI
    );
    engine.RegisterSignatureProcessor(
        std::make_shared<TrafficMask::IpSidrMasker>()  // –†–æ—Å—Å–∏–π—Å–∫–∏–π IP SIDR
    );
    engine.RegisterSignatureProcessor(
        std::make_shared<TrafficMask::VkTunnelMasker>() // VK Tunnel
    );
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
    TrafficMask::Packet packet(data, timestamp, connection_id, true);
    engine.ProcessPacket(packet);
    
    engine.Shutdown();
    return 0;
}
```

#### Python API –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤

```python
import requests

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π SNI —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
requests.post("http://localhost:8080/api/v1/signatures", 
    json={"signature": "russia_sni_example.com", "type": "sni_masker"})

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ IP SIDR —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
requests.post("http://localhost:8080/api/v1/signatures",
    json={"signature": "russia_ip_192.168.1.0/24", "type": "ip_sidr_masker"})

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ VK Tunnel —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
requests.post("http://localhost:8080/api/v1/signatures",
    json={"signature": "vk_tunnel_app", "type": "vk_tunnel_masker"})
```

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –†–æ—Å—Å–∏–π—Å–∫–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–∏

```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
python examples/russia_features_demo.py

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π IP –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
curl -X POST http://localhost:8080/api/v1/signatures \
  -H "Content-Type: application/json" \
  -d '{"signature": "russia_ip_test", "type": "ip_sidr_masker"}'

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ VK Tunnel –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
curl -X POST http://localhost:8080/api/v1/signatures \
  -H "Content-Type: application/json" \
  -d '{"signature": "vk_tunnel_test", "type": "vk_tunnel_masker"}'
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤

### –†–æ—Å—Å–∏–π—Å–∫–∏–π SNI Masker
- **–°–∫–æ—Ä–æ—Å—Ç—å**: ~1.2M –ø–∞–∫–µ—Ç–æ–≤/—Å–µ–∫
- **–ü–∞–º—è—Ç—å**: ~2MB –Ω–∞ 1000 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **CPU**: ~4% –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ

### –†–æ—Å—Å–∏–π—Å–∫–∏–π IP SIDR Masker
- **–°–∫–æ—Ä–æ—Å—Ç—å**: ~2.1M –ø–∞–∫–µ—Ç–æ–≤/—Å–µ–∫  
- **–ü–∞–º—è—Ç—å**: ~1.5MB –Ω–∞ 1000 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **CPU**: ~2.5% –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ

### VK Tunnel Masker
- **–°–∫–æ—Ä–æ—Å—Ç—å**: ~800K –ø–∞–∫–µ—Ç–æ–≤/—Å–µ–∫
- **–ü–∞–º—è—Ç—å**: ~3MB –Ω–∞ 1000 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **CPU**: ~6% –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤

### –ó–∞–∫–æ–Ω–Ω–æ—Å—Ç—å
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º—É –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- ‚úÖ –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ —Å–µ—Ç—è–º–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –æ—Ç DPI
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- **–†–æ—Å—Å–∏–π—Å–∫–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã**: –ú–¢–°, –ú–µ–≥–∞–§–æ–Ω, –ë–∏–ª–∞–π–Ω, –¢–µ–ª–µ2, –†–æ—Å—Ç–µ–ª–µ–∫–æ–º
- **–†–æ—Å—Å–∏–π—Å–∫–∏–µ –¥–æ–º–µ–Ω—ã**: .ru, .—Ä—Ñ, —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –ø–æ–¥–¥–æ–º–µ–Ω—ã
- **–ü—Ä–æ—Ç–æ–∫–æ–ª—ã**: HTTP/HTTPS, WebSocket, TLS 1.0-1.3
- **CDN**: –Ø–Ω–¥–µ–∫—Å CDN, Mail.ru CDN, VK CDN

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤

### –ú–µ—Ç—Ä–∏–∫–∏ SNI
- `russia_sni_packets_processed` - –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö SNI –ø–∞–∫–µ—Ç–æ–≤
- `russia_domains_masked` - –ó–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–æ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤
- `russia_sni_masking_errors` - –û—à–∏–±–∫–∏ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π SNI –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏

### –ú–µ—Ç—Ä–∏–∫–∏ IP SIDR
- `russia_ip_packets_processed` - –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö IP –ø–∞–∫–µ—Ç–æ–≤
- `russia_ip_addresses_masked` - –ó–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–æ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö IP –∞–¥—Ä–µ—Å–æ–≤
- `russia_ip_checksum_recalculated` - –ü–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö IP checksums

### –ú–µ—Ç—Ä–∏–∫–∏ VK Tunnel
- `vk_tunnel_packets_processed` - –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ VK Tunnel –ø–∞–∫–µ—Ç–æ–≤
- `vk_tunnel_domains_masked` - –ó–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–æ VK Tunnel –¥–æ–º–µ–Ω–æ–≤
- `vk_tunnel_websocket_upgrades` - –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ WebSocket –∞–ø–≥—Ä–µ–π–¥–æ–≤

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –†–æ—Å—Å–∏–π—Å–∫–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–∏
- **–ü—Ä–æ–±–ª–µ–º–∞**: SNI –Ω–µ –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –¥–æ–º–µ–Ω—ã
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### IP SIDR –ø—Ä–æ–±–ª–µ–º—ã
- **–ü—Ä–æ–±–ª–µ–º–∞**: –†–æ—Å—Å–∏–π—Å–∫–∏–µ IP –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
- **–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –ø—É–ª–∞ IP –∞–¥—Ä–µ—Å–æ–≤

### VK Tunnel –ø—Ä–æ–±–ª–µ–º—ã
- **–ü—Ä–æ–±–ª–µ–º–∞**: VK Tunnel –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è VK –¥–æ–º–µ–Ω–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

–†–æ—Å—Å–∏–π—Å–∫–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤—â–∏–∫–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ–¥ —Ç–æ–π –∂–µ –ª–∏—Ü–µ–Ω–∑–∏–µ–π, —á—Ç–æ –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç TrafficMask, —Å —É—á–µ—Ç–æ–º —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞.
